      SUBROUTINE SOLPRO(TAU,IQ,F,INALE)
C *** MODIFIED 9/77 TO RETURN INALE(# OF AL EVENTS) TO CALLING PROGRAM
C *** INTERPLANETARY SOLAR PROTON FLUX AT 1 AU (FROM E>10 TO E>200 MEV
C *** FOR ANOMALOUSLY LARGE (AL) EVENTS AND FROM E>10 TO E>100 MEV FOR
C *** ORDINARY (OR) EVENTS)
C *** SINGLE PRECISION DECK IN STANDARD FORTRAN IV FOR IBM 360 MACHINES
C *** (EBCDIC, 029 PUNCH) OR OTHER COMPATIBLE SYSTEMS.
C *** PROGRAM DESIGNED AND TESTED BY E.G. STASSINOPOULOS, CODE 601,
C *** NASA GODDARD SPACE FLIGHT CENTER, GREENBELT, MARYLAND 20771 .
C *********************************************************************
C ****  INPUT: TAU     MISSION DURATION IN MONTHS (REAL*4)
C ****         IQ      CONFIDENCE LEVEL THAT CALCULATED FLUENCE F(N)
C ****                 WILL NOT BE EXCEEDED (INTEGER*4)
C **** OUTPUT: F(N)    SPECTRUM OF INTEGRAL SOLAR PROTON FLUENCE FOR
C ****                 ENERGIES E>10*N (1=<N=<20) FOR AL EVENTS
C ****                 ENERGIES E>10*N (1=<N=<10) FOR OR EVENTS
C ****         INALE   # OF AL EVENTS FOR GIVEN TAU AND Q
      REAL NALE,NALECF(7,20)/-.1571,.2707,-.1269E-1,.4428E-3,-.8185E-5,
     $.7754E-7,-.2939E-9,-.1870,.1951,-.6559E-2,.1990E-3,-.3618E-5,
     $.3740E-7,-.1599E-9,-.2007,.1497,-.3179E-2,.5730E-4,-.4664E-6,
     $.1764E-8,0.,-.1882,.1228,-.1936E-2,.2660E-4,-.1022E-6,2*0.,
     $-.2214,.1149,-.1871E-2,.2695E-4,-.1116E-6,2*0.,-.2470,.1062,
     $-.1658E-2,.2367E-4,-.9465E-7,2*0.,-.2509,.8710E-1,-.8300E-3,
     $.8438E-5,3*0.,-.2923,.8932E-1,-.1023E-2,.1029E-4,3*0.,-.3222,
     $.8648E-1,-.9992E-3,.9935E-5,3*0.,-.3518,.8417E-1,-.1000E-2,
     $.9956E-5,3*0.,-.3698,.7951E-1,-.8983E-3,.8940E-5,3*0.,-.2771,
     $.5473E-1,-.1543E-4,4*0., -.2818,.5072E-1,.2511E-4,4*0.,-.2845,
     $.4717E-1,.5664E-4,4*0.,-.2947,.4405E-1,.8507E-4,4*0.,-.2923,
     $.4111E-1,.1106E-3,4*0.,-.2981,.3853E-1,.1312E-3,4*0.,-.3002,
     $.3585E-1,.1529E-3,4*0.,-.3001,.3312E-1,.1781E-3,4*0.,-.3141,
     $.3248E-1,.1654E-3,4*0./,F(20),G(20)
      REAL ORFLXC(5,9)/.154047E3,-.522258E4,.714275E5,-.432747E6,.955315
     $E6,.198004E3,-.448788E4,.438148E5,-.196046E6,.32552E6,.529120E3,
     $-.122227E5,.112869E6,-.465084E6,.710572E6,.121141E4,-.266412E5,
     $.226778E6,-.85728E6,.120444E7,.452062E4,-.103248E6,.896085E6,
     $-.346028E7,.499852E7,.272028E4,-.499088E5,.35305E6,-.111929E7,
     $.133386E7,.275597E4,-.469718E5,.314729E6,-.960383E6,.11165E7,
     $.570997E4,-.799689E5,.381074E6,-.610714E6,0.,.101E3,4*0./
      INTEGER INDEX(20)/2*7,6,3*5,5*4,9*3/
    1 FORMAT(' TAU=',F4.0,' IQ=',I3,3X,'PARAMETER(S) EXCEED PROGRAM LIMI
     $TS')
    2 FORMAT(2X,'FOR THE COMBINATION OF TAU AND IQ GIVEN, NO SIGNIFICANT
     $ SOLAR PROTON FLUXES ARE TO BE EXPECTED. TAU=',F6.2,' IQ=',I2)
      IF(TAU.GT.72..OR.IQ.LT.80)GO TO 500
      IP=100-IQ
      M=INDEX(IP)
      NALE=0.
      DO 300 J=1,M
  300 NALE=NALE+NALECF(J,IP)*TAU**(J-1)
      INALE=NALE+1.0001
      IF(INALE.GT.0) GO TO 400
C *** CALCULATIONS FOR OR-EVENT CONDITIONS
      IT=TAU
      IF(IT.EQ.1.AND.IP.GT.16) GO TO 700
      P=FLOAT(IP)/100.
      OF=0.
      DO 100 J=1,5
  100 OF=OF+ORFLXC(J,IT)* P**(J-1)*1.E7
      E=10.
      DO 200 N=1,10
      G(N)=EXP(.0158*(30.-E))
      F(N)=OF*G(N)
  200 E=E+10.
      GO TO 800
C *** CALCULATIONS FOR AL-EVENT CONDITIONS
  400 E=10.
      DO 600 N=1,20
      F(N)=7.9E9*EXP((30.-E)/26.5)*INALE
  600 E=E+10.
      GO TO 800
  700 WRITE(6,2) TAU,IQ
      GO TO 800
  500 WRITE (6,1) TAU,IQ
  800 RETURN
      EN)
